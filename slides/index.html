<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

    <title>Create Your First Linter</title>

    <link rel="stylesheet" href="dist/reset.css">
    <link rel="stylesheet" href="dist/reveal.css">
    <link rel="stylesheet" href="dist/theme/moon.css">

    <!-- Theme used for syntax highlighted code -->
    <link rel="stylesheet" href="plugin/highlight/monokai.css">

    <style type="text/css">
        section {
            text-align: left;
        }

        .tiny {
            font-size: 22px;
        }
    </style>

    <script>
        const now = new Date();

        function addMinutes(date, minutes) {
            return new Date(date.getTime() + minutes * 60000);
        }

        function formatHHmm(date) {
            return date.toTimeString().split(' ')[0].slice(0, -3)
        }

        // Agenda auto-time calculation: computes the HH:mm for each agenda item
        // based on a start time and each item's duration.
        document.addEventListener('DOMContentLoaded', function () {
            // More robust: target the specific Agenda list under the Agenda section title
            const agendaHeader = Array.from(document.querySelectorAll('section h2'))
                .find(h2 => h2.textContent.trim().toLowerCase() === 'agenda');
            if (!agendaHeader) return;
            const agendaContainer = agendaHeader.closest('section');
            if (!agendaContainer) return;
            const ul = agendaContainer.querySelector('ul');
            if (!ul) return;

            // Defaults to 'now' captured at page load.
            let start = new Date(now.getTime());
            // Iterate items and fill in their time placeholders
            let cursor = new Date(start.getTime());
            ul.querySelectorAll('li').forEach((li, _) => {
                // 1) Find <time class="agenda-time"></time> placeholder
                let timeEl = li.querySelector('time.agenda-time');
                if (!timeEl) return;
                // 2) Determine duration minutes
                let minutes = Number(li.getAttribute('data-duration'));
                if (!Number.isFinite(minutes)) {
                    const m = li.textContent.match(/\(~\s*(\d+)\s*m\s*\)/i);
                    minutes = m ? Number(m[1]) : 0;
                }

                // 3) Set the computed time
                timeEl.textContent = formatHHmm(cursor);

                // 4) Advance cursor for the next item
                cursor = addMinutes(cursor, minutes || 0);
            });
        });
    </script>
</head>
<body>
<div class="reveal">
    <div class="slides">
        <section id="title">
            <div style="display: flex; justify-content: space-between; align-items: center;">
                <!-- Left side: text or content -->
                <div style="flex: 8; padding-right: 20px;">
                    <h1>Create Your First Linter</h1>
                    <p class="tiny">
                        Manuel Doncel Martos -
                        <script>
                            document.write(now.toLocaleDateString());
                        </script>
                    </p>
                    <p class="tiny">
                        <small>Powered by <a href="https://revealjs.com/">reveal.js</a></small>
                    </p>
                </div>

                <!-- Right side: image -->
                <div style="flex: 4; text-align: center;">
                    <a target="_blank" href="https://manuelarte.github.io/create-your-first-linter">
                        <img src="./assets/qr-slides.jpeg" alt="QR Code Slides"
                             style="max-width: 100%; max-height: 600px;">
                    </a>
                </div>
            </div>

            <aside class="notes">
                Hello, welcome to the presentation about "Create Your First Linter" in Go.
                The goal of this presentation is to provide you with the knowledge and tools necessary to create your
                own linters.
                We are going to create our first linter (a very dummy one) and we will run it as a binary,
                and we will also see how to integrate it in golangci-lint.

                But let's start with the basics, what is a linter? Anyone wants to give it a try and define it?
                (we have the definition on the next slide)
            </aside>

        </section>
        <section id="linter-definition">
            <section>
                <h3>Linter</h3>
                <blockquote cite="">
                    Automatically analyze source code for potential errors, stylistic issues, and violations of coding
                    conventions
                </blockquote>

                <aside class="notes">
                    Here we have the definition. A linter is a tool that automatically analyzes source code for, not
                    only potential errors, but also a linter that can be used to enforce coding conventions.

                    When you review a PR, you need to review both the technical implementation
                    and also the business logic.
                    By using linters, we can reduce part of the technical review.
                    And that's where I would like to help you.
                </aside>

            </section>
        </section>
        <section>
            <h2>About me</h2>
            <div style="display: flex; justify-content: space-between; align-items: center;">
                <!-- Left side: text or content -->
                <div style="flex: 8; padding-right: 20px;">
            <pre><code data-trim data-noescape data-line-numbers
                       class="language-go">
            var Me = Developer{
                Name: "Manuel Doncel Martos",
                Skills: [][]string{
                  {"‚òïJava", "Spring Boot"},
                  {"ü¶´Go", "üêçPython"},
                  {"Kubernetes", "Docker"},
                },
                Interests: []string {
                  "Open Source",
                  "Domain Driven Design",
                  "‚öΩFootball",
                },
            }
            </code></pre>
                </div>

                <!-- Right side: image -->
                <div style="flex: 4; text-align: center;">
                    <a target="_blank" href="http://github.com/manuelarte">
                        <img src="./assets/qr-github-manuelarte.jpeg" alt="QR Code GitHub manuelarte"
                             style="max-width: 100%; max-height: 600px;">
                    </a>
                </div>
            </div>

            <aside class="notes">
                My name is Manuel Doncel Martos, I'm a software developer with experience in Java and Go,
                I have quite some experience in Java, but the last 3 years I have been working with Go.
                I have open source projects and some of then are several linters that are used in my current projects.
                Two of them are actually integrated in golangci-lint,
                and I would like to share my experience with you, and hopefully inspire you to create your own linters.
            </aside>
        </section>
        <section>
            <h2>Agenda</h2>
            <!-- Optionally set a fixed start time for the agenda using data-start="HH:MM" -->
            <ul>
                <li data-duration="5">
                    <a href="#/golangci-lint-in-a-nutshell">Golangci-lint in a nutshell</a>
                    <time class="agenda-time"></time>
                    (~5m)
                </li>
                <li data-duration="10">
                    <a href="#/create-your-first-linter">Create your first linter</a>
                    <time class="agenda-time"></time>
                    (~10m)
                </li>
                <li data-duration="5">
                    <a href="#/my-linters">My linters</a>
                    <time class="agenda-time"></time>
                    (~5m)
                </li>
                <li data-duration="15">
                    <a href="#/integrate-custom-linter">Integrate custom linter</a>
                    <time class="agenda-time"></time>
                    (~15m)
                </li>
                <li data-duration="5">
                    <a href="#/qa">Q/A</a>
                    <time class="agenda-time"></time>
                    (~5m)
                </li>
            </ul>

            <aside class="notes">
                This is the agenda. First we are going to briefly review what's golangci-lint.
                We are going to see some of the tooling that library uses.
                Then we are moving to create our first linter, a very dummy one based on the Uber style guidelines.
                After that I am going to briefly explain the two linters that I have created,
                to check some of the possibilities when creating a linter.
                And then we are going to integrate the linter we created inside golangci-lint and run it in a small
                project.
                Does it sound good? Let's go.
            </aside>
        </section>
        <section id="golangci-lint-in-a-nutshell">
            <section>
                <h2>golangci-lint</h2>

                <p><a href="https://golangci-lint.run/" target="_blank">Golangci-lint</a> is a fast linters runner for
                    Go.</p>
                <div style="display: flex; justify-content: space-between; align-items: center;">
                    <!-- Left side: text or content -->
                    <div style="flex: 6; padding-right: 20px;">
                        <ul>
                            <li>Widely used.</li>
                            <li>More than 100 linters.</li>
                            <li>Run linters.</li>
                            <li>Run formatters.</li>
                        </ul>
                    </div>

                    <!-- Right side: image -->
                    <div style="flex: 6; text-align: center;">
                            <pre><code class="language-plantuml">
                            @startuml
                            skinparam backgroundColor transparent
                            skinparam monochrome reverse
                            !option handwritten true

                            revive - [golangci-lint]
                            gofmt - [golangci-lint]
                            gofumpt - [golangci-lint]
                            gci - [golangci-lint]
                            ... - [golangci-lint]
                            funcorder -- [golangci-lint]
                            embeddedstructfieldcheck -- [golangci-lint]

                            @enduml
                            </code></pre>

                    </div>
                </div>

                <aside class="notes">
                    How many of you are using golangci-lint in your projects? Hopefully most of you.
                    Golangci-lint is the most used linter tool in Go. It contains more than 100 linters and many
                    formatters.
                    The difference between a linter and a formatter is that a linter is detecting issues, and a
                    formatter
                    is just formatting code. Examples of formatters are gci, to format the imports.
                </aside>
            </section>
            <section>
                <h3>Example configurations</h3>
                <pre><code data-trim data-noescape>
            version: 2
            </code></pre>
                <p>Others:</p>
                <ul class="tiny">
                    <li><a target="_blank" href="https://github.com/ccoVeille/golangci-lint-config-examples/">
                        https://github.com/ccoVeille/golangci-lint-config-examples/</a>
                    </li>
                    <li>
                        <a target="_blank" href="https://gist.github.com/maratori/47a4d00457a92aa426dbd48a18776322">https://gist.github.com/maratori/47a4d00457a92aa426dbd48a18776322</a>
                    </li>

                    <li>
                        <a target="_blank" href="https://gist.github.com/manuelarte/76c3cedb1f819184a9a880883e6edd5f">https://gist.github.com/manuelarte/76c3cedb1f819184a9a880883e6edd5f</a>
                    </li>
                </ul>

                <aside class="notes">
                    golangci-lint can be configured with a configuration file. That it can be as simple as:
                    But also there are so many linters and so many parameters to configure that it is important
                    to expend some time on it and adapt it to your projects coding standards.

                    Here you have some examples of configuration files that you can use as template,
                    but it's important that you adjust them to your needs.

                    It does not really matter if you don't follow, or you disable some linters, as long as
                    your code is consistent.
                </aside>
            </section>
            <section>
                <h3>Tools Analyzer</h3>
                <p>Package <a target="_blank" href="https://pkg.go.dev/golang.org/x/tools">golang.org/x/tools</a></p>
                <ul>
                    <li>Node</li>
                    <li>Analyzer</li>
                    <li>Pass</li>
                    <li>Diagnosis</li>
                </ul>
            </section>
            <section>
                <h3>AST Parser</h3>
                <pre><code class="language-plantuml">
              @startwbs

              skinparam backgroundColor transparent
              skinparam monochrome reverse
              !option handwritten true

              * ast.File
              ** ast.GenDecl
              *** ast.ImportSpec
              **** ast.BasicLit
              ** ast.GenDecl
              *** ast.ValueSpec
              **** ast.Ident
              **** ast.BasicLit
              ** ast.GenDecl
              *** ast.TypeSpec
              *** ast.StructType
              **** ast.FieldList
              ***** ast.Field
              ***** ast.Field
              ** ast.FuncDecl
              *** ast.FuncType
              *** ast.FieldList
              **** ast.Field
              **** ast.Field
              ** ...

              @endwbs
              </code></pre>
                <p>File to test: <a target="_blank"
                                    href="https://github.com/manuelarte/presentation-create-your-first-linter/blob/main/astexample/testdata/src/simple/simple.go">here</a>
                </p>
                <aside class="notes">
                    If you want to add a linter in golangci-lint, you need to use this library.
                    This library is on charge of parsing the source code, and build the abstract syntax tree.
                </aside>
            </section>
        </section>
        <section id="create-your-first-linter">
            <section>
                <h2>Create your first linter</h2>
                <p><a target="_blank"
                      href="https://github.com/uber-go/guide/blob/master/style.md#prefix-unexported-globals-with-_">Prefix
                    unexported globals with
                    <it>'_'</it>
                    .</a>
                </p>
                <div style="display: flex; justify-content: space-between; align-items: center;">
                    <!-- Left side: text or content -->
                    <div style="flex: 1; padding-right: 20px;">
                        ‚ùå Bad
                        <pre><code data-trim data-noescape data-line-numbers
                                   class="language-go">
                const myConstant = "myConstant"
                const errNotFound = "not found"
              </code></pre>
                    </div>

                    <!-- Right side: image -->
                    <div style="flex: 1; text-align: center;">
                        ‚úÖ Good
                        <pre><code data-trim data-noescape data-line-numbers
                                   class="language-go">
                const _myConstant = "myConstant"
                const errNotFound = "not found"
              </code></pre>
                    </div>
                </div>

                <ul class="tiny">
                    <li>Identify</li>
                    <li>Suggest fix</li>
                </ul>
            </section>
            <section>
                <h3>Let's</h3>
                <img src="./assets/gopher.png" alt="go">
            </section>
        </section>
        <section id="my-linters">
            <section>
                <h2>üßê My linters</h2>
                <ul>
                    <li><a target="_blank" href="https://github.com/manuelarte/funcorder">FuncOrder</a></li>
                    <li><a target="_blank" href="https://github.com/manuelarte/embeddedstructfieldcheck">EmbeddedStructFieldCheck</a>
                    </li>
                </ul>
            </section>
            <section>
                <p><a target="_blank" href="https://github.com/manuelarte/funcorder">FuncOrder</a></p>

                <p>Based on <a target="_blank"
                               href="https://github.com/uber-go/guide/blob/master/style.md#function-grouping-and-ordering">function
                    grouping and ordering.</a></p>

                <div style="display: flex; justify-content: space-between; align-items: center;">
                    <!-- Left side: text or content -->
                    <div style="flex: 6; padding-right: 20px;">
                        ‚ùå Bad
                        <pre><code data-trim data-noescape data-line-numbers
                                   class="language-go">
                        // ‚ùå constructor before
                        // struct declaration
                        func NewMyStruct() *MyStruct {
                            return &MyStruct{}
                        }

                        type MyStruct struct {
                            Name string
                        }

                        // ‚ùå unexported method
                        // placed before exported method
                        func (m MyStruct) lenName() int {
                            return len(m.Name)
                        }

                        func (m MyStruct) GetName() string {
                            return m.Name
                        }

                        ...
                 </code></pre>
                    </div>

                    <!-- Right side: image -->
                    <div style="flex: 6; text-align: center;">
                        ‚úÖ Good
                        <pre><code data-trim data-noescape data-line-numbers
                                   class="language-go">
                        type MyStruct struct {
                            Name string
                        }

                        // ‚úÖ constructor after
                        // struct declaration and
                        // before methods
                        func NewMyStruct() *MyStruct {
                            return &MyStruct{}
                        }

                        // ‚úÖ exported methods before
                        // unexported methods
                        func (m MyStruct) GetName() string {
                            return m.Name
                        }

                        func (m MyStruct) lenName() int {
                            return len(m.Name)
                        }

                        ...
                  </code></pre>
                    </div>
                </div>
            </section>
            <section>
                <p><a target="_blank" href="https://github.com/manuelarte/embeddedstructfieldcheck">EmbeddedStructFieldCheck</a>
                </p>

                <p>Based on <a target="_blank"
                               href="https://github.com/uber-go/guide/blob/master/style.md#embedding-in-structs">embedding
                    in structs.</a></p>

                <div style="display: flex; justify-content: space-between; align-items: center;">
                    <!-- Left side: text or content -->
                    <div style="flex: 6; padding-right: 20px;">
                        ‚ùå Bad
                        <pre><code data-trim data-noescape data-line-numbers
                                   class="language-go">
                        type Client struct {
                          version int
                          http.Client
                        }
                 </code></pre>
                    </div>

                    <!-- Right side: image -->
                    <div style="flex: 6; text-align: center;">
                        ‚úÖ Good
                        <pre><code data-trim data-noescape data-line-numbers
                                   class="language-go">
                        type Client struct {
                          http.Client

                          version int
                        }
                  </code></pre>
                    </div>
                </div>
            </section>
            <section>
                <h3>Comments</h3>
                <ul>
                    <li>Stylistic linters help a lot in big projects.</li>
                    <li>Be consistent.</li>
                </ul>
            </section>
        </section>
        <section id="integrate-custom-linter">
            <section>
                <h2>Integrate custom linter</h2>
                <ul>
                    <li>As a binary</li>
                    <li>In Golangci Lint</li>
                </ul>
            </section>
            <section>
                <h2>As a binary</h2>
                <pre><code data-trim data-noescape data-line-numbers
                           class="language-bash">
                        cd ./unexportedconstantscheck && go build -o unexportedconstantscheck ./cmd/.
                        cd ../custom-plugin && ../unexportedconstantscheck/unexportedconstantscheck --fix ./...
                  </code></pre>
            </section>
            <section>
                <h2>Golangci: Create custom plugin</h2>
                <p>More info: <a href="https://golangci-lint.run/plugins/module-plugins/" target="_blank">Module
                    Plugin</a></p>
                <p>Example: <a
                        href="https://github.com/manuelarte/presentation-create-your-first-linter/tree/main/custom-plugin"
                        target="_blank">Custom Plugin</a></p>
            </section>
            <section>
                <h3>Let's</h3>
                <img src="./assets/gopher.png" alt="go">
            </section>
            <section>
                <h3>Takeaways</h3>
                <ul>
                    <li>Easy to create custom linters.</li>
                    <li>Reduce cognitive load.</li>
                    <li>Enjoyable experience.</li>
                </ul>
            </section>

        </section>
        <section data-background-image="./assets/q_a.jpeg" data-background-size="75%" id="qa">
            <div style="display: flex; justify-content: space-between; align-items: center;">
                <!-- Left side: text or content -->
                <div style="flex: 8; padding-right: 20px;">
                    <h1>Q/A</h1>
                </div>
                <!-- Right side: image -->
                <div style="flex: 4; text-align: center;">
                    <img src="./assets/qrcode_docs.google.com.png" alt="form">
                </div>
            </div>
        </section>

    </div>
</div>

<script src="dist/reveal.js"></script>
<script src="plugin/notes/notes.js"></script>
<script src="plugin/markdown/markdown.js"></script>
<script src="plugin/highlight/highlight.js"></script>
<script>
    // More info about initialization & config:
    // - https://revealjs.com/initialization/
    // - https://revealjs.com/config/
    Reveal.initialize({
        hash: true,
        navigationMode: "linear",
        slideNumber: true,
        progress: true,
        dependencies: [
            {src: '//cdn.jsdelivr.net/npm/reveal-plantuml'},
        ],
        // Learn about plugins: https://revealjs.com/plugins/
        plugins: [RevealMarkdown, RevealHighlight, RevealNotes]
    });
</script>
</body>
</html>
